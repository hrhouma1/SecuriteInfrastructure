Voici le plan de cours ajusté avec le contenu ajouté au début :

# **Sécurité et Réponse aux Incidents**

1. <a href="#introduction-aux-attaques-et-à-la-sécurité">**Introduction aux Attaques et à la Sécurité**</a>
   - <a href="#objectif">Objectif</a>
   - <a href="#types-dattaques-courantes">Types d'Attaques Courantes</a>
   - <a href="#phishing">Phishing</a>
   - <a href="#ddos-denial-of-service-distribué">DDoS (Denial of Service Distribué)</a>
   - <a href="#ransomware">Ransomware</a>
   - <a href="#pourquoi-surveiller-les-activités-au-sein-dune-infrastructure">Pourquoi Surveiller les Activités au Sein d'une Infrastructure ?</a>
   - <a href="#exemples-réels-dattaques-et-leur-impact">Exemples Réels d'Attaques et Leur Impact</a>

2. <a href="#détection-des-violations-de-sécurité">**Détection des Violations de Sécurité**</a>
   - <a href="#system-monitor-sysmon">System Monitor (Sysmon)</a>
   - <a href="#téléchargement-et-installation-de-sysmon">Téléchargement et Installation de Sysmon</a>
   - <a href="#configuration-de-sysmon">Configuration de Sysmon</a>
   - <a href="#surveillance-des-événements-avec-sysmon">Surveillance des Événements avec Sysmon</a>
   - <a href="#exemple-pratique">Exemple Pratique</a>
   - <a href="#process-monitor">Process Monitor</a>
   - <a href="#téléchargement-et-lancement-de-process-monitor">Téléchargement et Lancement de Process Monitor</a>
   - <a href="#filtrage-des-activités">Filtrage des Activités</a>
   - <a href="#surveillance-en-temps-réel">Surveillance en Temps Réel</a>
   - <a href="#analyse-des-résultats">Analyse des Résultats</a>
   - <a href="#exemple-pratique-1">Exemple Pratique</a>

3. <a href="#examen-de-lactivité-avec-les-outils-sysinternals">**Examen de l'Activité avec les Outils Sysinternals**</a>
   - <a href="#présentation-des-outils-sysinternals">Présentation des Outils Sysinternals</a>
   - <a href="#process-explorer">Process Explorer</a>
   - <a href="#autoruns">Autoruns</a>
   - <a href="#stratégies-dinvestigation-avec-sysinternals">Stratégies d'Investigation avec Sysinternals</a>
   - <a href="#approche-globale">Approche Globale</a>
   - <a href="#précautions-et-meilleures-pratiques">Précautions et Meilleures Pratiques</a>
   - <a href="#conclusion-avant-la-démonstration-pratique">Conclusion avant la Démonstration Pratique</a>

4. <a href="#stratégies-de-réponse-aux-incidents">**Stratégies de Réponse aux Incidents**</a>
   - <a href="#scénario-dentreprise-attaquée">Scénario d'Entreprise Attaquée</a>
   - <a href="#discussion-interactive">Discussion Interactive</a>
   - <a href="#plan-de-réponse-aux-incidents">Plan de Réponse aux Incidents</a>
   - <a href="#isolation-des-systèmes-compromis">Isolation des Systèmes Compromis</a>
   - <a href="#communication-de-crise">Communication de Crise</a>
   - <a href="#restauration-des-systèmes">Restauration des Systèmes</a>
   - <a href="#post-mortem-et-amélioration-continue">Post-Mortem et Amélioration Continue</a>

5. <a href="#atelier-pratique">**Atelier Pratique**</a>
   - <a href="#préambule--choix-du-système-dexploitation">Préambule : Choix du Système d'Exploitation</a>
   - <a href="#exercice-1--configurer-sysmon-sur-une-machine-virtuelle-et-détecter-une-activité-anormale">Exercice 1 : Configurer Sysmon sur une Machine Virtuelle et Détecter une Activité Anormale</a>
   - <a href="#exercice-2--utiliser-process-monitor-pour-suivre-lactivité-dun-processus-malveillant-simulé">Exercice 2 : Utiliser Process Monitor pour Suivre l'Activité d'un Processus Malveillant Simulé</a>
   - <a href="#exercice-3--analyser-une-machine-infectée-avec-les-outils-sysinternals-et-rédiger-un-rapport-dincident">Exercice 3 : Analyser une Machine Infectée avec les Outils Sysinternals et Rédiger un Rapport d'Incident</a>

6. <a href="#conclusion-et-qa">**Conclusion et Q&A**</a>
   - <a href="#synthèse">Synthèse</a>
   - <a href="#questions-et-réponses">Questions et Réponses</a>

---

### <a name="introduction-aux-attaques-et-à-la-sécurité"></a>Introduction aux Attaques et à la Sécurité

- <a name="objectif"></a>**Objectif** : Sensibiliser aux différents types d'attaques courantes qui menacent les infrastructures informatiques modernes. Les attaques comme le phishing, les attaques par déni de service distribué (DDoS), et les ransomwares sont devenues de plus en plus sophistiquées et fréquentes. Comprendre ces attaques est essentiel pour mettre en place des stratégies efficaces de surveillance et de réponse.
- <a name="types-dattaques-courantes"></a>**Types d'Attaques Courantes**
  - <a name="phishing"></a>**Phishing**
    - **Description** : Le phishing est une technique d'attaque qui consiste à tromper les utilisateurs pour qu'ils divulguent des informations sensibles (comme des identifiants de connexion ou des informations bancaires) en se faisant passer pour une entité de confiance, souvent via des emails ou des sites web falsifiés.
    - **Mécanisme** : Les attaquants envoient des emails contenant des liens vers des sites web factices ou des pièces jointes malveillantes. Lorsque l'utilisateur clique sur le lien ou ouvre la pièce jointe, il peut être amené à entrer ses informations personnelles, qui sont ensuite collectées par les cybercriminels.
    - **Exemple Réel** : En 2020, une campagne de phishing massive a ciblé les utilisateurs de Microsoft Office 365, où des emails se faisant passer pour des notifications de mise à jour de compte ont incité les utilisateurs à entrer leurs identifiants sur un site frauduleux.
  - <a name="ddos-denial-of-service-distribué"></a>**DDoS (Denial of Service Distribué)**
    - **Description** : Les attaques DDoS visent à rendre un service ou un site web indisponible en le submergeant de requêtes simultanées provenant de multiples systèmes compromis (appelés botnets).
    - **Mécanisme** : Ces attaques exploitent la capacité limitée d'un serveur à traiter un nombre important de requêtes, le saturant jusqu'à ce qu'il devienne incapable de répondre aux requêtes légitimes.
    - **Exemple Réel** : En 2016, l'attaque DDoS sur Dyn, un fournisseur de DNS, a provoqué la panne de nombreux services majeurs, y compris Twitter, Netflix, et Reddit. Cette attaque a été menée en utilisant le botnet Mirai, qui exploitait des milliers d'appareils IoT.
  - <a name="ransomware"></a>**Ransomware**
    - **Description** : Un ransomware est un type de logiciel malveillant qui chiffre les fichiers de la victime et exige une rançon en échange de la clé de déchiffrement.
    - **Mécanisme** : L'infection peut se produire via des emails de phishing, des téléchargements malveillants, ou des failles de sécurité dans des systèmes non mis à jour. Une fois le ransomware installé, il commence à chiffrer les fichiers de l'utilisateur, rendant le système inutilisable.
    - **Exemple Réel** : WannaCry, en 2017, est l'une des attaques de ransomware les plus célèbres. Exploitant une vulnérabilité dans le système Windows, il a infecté plus de 230 000 ordinateurs dans 150 pays, affectant des organisations telles que le National Health Service (NHS) au Royaume-Uni.

- <a name="pourquoi-surveiller-les-activités-au-sein-dune-infrastructure"></a>**Pourquoi Surveiller les Activités au Sein d'une Infrastructure ?**
  - **Prévention des Violations de Données**
    - **Description** : La surveillance des activités réseau et des systèmes permet

 de détecter les comportements anormaux ou non autorisés avant qu'ils ne causent des dommages importants.
    - **Exemple** : Une tentative d'accès non autorisé à une base de données sensible peut être rapidement identifiée et bloquée avant que les données ne soient exfiltrées.
  - **Réponse Rapide aux Incidents**
    - **Description** : Lorsqu'une attaque est détectée en temps réel, les équipes de sécurité peuvent intervenir immédiatement pour limiter l'impact, isoler les systèmes compromis, et commencer la récupération.
    - **Exemple** : Lors d'une attaque par ransomware, la détection précoce de l'activité de chiffrement peut permettre de déconnecter les systèmes avant que l'intégralité du réseau ne soit affectée.
  - **Conformité Réglementaire**
    - **Description** : De nombreuses industries sont soumises à des régulations strictes concernant la protection des données. La surveillance continue aide à garantir que l'entreprise respecte ces exigences légales.
    - **Exemple** : Le RGPD en Europe impose aux entreprises de signaler toute violation de données dans les 72 heures. Une surveillance efficace permet de respecter cette obligation légale.

- <a name="exemples-réels-dattaques-et-leur-impact"></a>**Exemples Réels d'Attaques et Leur Impact**
  - **L'attaque sur Target en 2013**
    - **Contexte** : Target, une chaîne de magasins américaine, a subi une des plus grandes violations de données de l'histoire, où les informations de carte de crédit de 40 millions de clients ont été compromises.
    - **Impact** : L'attaque a entraîné des pertes financières considérables, une baisse de confiance des clients, et des poursuites judiciaires. Elle a aussi poussé Target à investir massivement dans l'amélioration de sa cybersécurité.
  - **L'attaque de SolarWinds en 2020**
    - **Contexte** : Une compromission sophistiquée d'une mise à jour logicielle de SolarWinds, une société de gestion de réseau, a permis aux attaquants d'accéder aux systèmes de nombreuses agences gouvernementales et entreprises de premier plan.
    - **Impact** : Cette attaque, qui a duré plusieurs mois avant d'être découverte, a mis en lumière les risques associés à la chaîne d'approvisionnement des logiciels et a conduit à des révisions des pratiques de sécurité au niveau national.

### **Conclusion**
Comprendre les attaques courantes et adopter une surveillance proactive sont des éléments clés pour protéger les infrastructures informatiques. En restant vigilant et en utilisant les outils appropriés, il est possible non seulement de prévenir les attaques mais aussi de réagir efficacement pour minimiser les dommages.

---

### <a name="détection-des-violations-de-sécurité"></a>Détection des Violations de Sécurité

[Revenir en haut](#sécurité-et-réponse-aux-incidents)

---



### <a name="détection-des-violations-de-sécurité"></a>2. Détection des Violations de Sécurité

Cette section guide à travers la configuration et l'utilisation de deux outils de surveillance essentiels dans un environnement Windows : **System Monitor (Sysmon)** et **Process Monitor**. Ces outils permettent de détecter et d'enregistrer les activités suspectes sur un système, offrant ainsi les moyens d'identifier les violations de sécurité avant qu'elles ne causent des dommages importants.

#### <a name="system-monitor-sysmon"></a>**2.1 System Monitor (Sysmon)**

**Objectif :**
Sysmon, un outil de la suite Sysinternals, permet de surveiller et d'enregistrer les événements système. Il est particulièrement utile pour capturer des détails sur la création de processus, les connexions réseau, et les modifications de fichiers, qui peuvent être utilisés pour identifier des activités suspectes.

**Étape 1 : Téléchargement et Installation de Sysmon**
- **Téléchargement :**
  1. Rendez-vous sur le site officiel des [Sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon).
  2. Téléchargez l'archive contenant Sysmon.
  3. Extrayez l'archive dans un répertoire de votre choix.

- **Installation :**
  1. Ouvrez une invite de commande avec les privilèges d'administrateur.
  2. Accédez au répertoire où Sysmon a été extrait.
  3. Tapez la commande suivante pour installer Sysmon avec la configuration par défaut :
     ```bash
     sysmon -accepteula -i
     ```
     Cette commande accepte l'accord de licence utilisateur final (EULA) et installe Sysmon en utilisant la configuration par défaut.

**Étape 2 : Configuration de Sysmon**
- **Création d'un Fichier de Configuration Personnalisé :**
  - La configuration par défaut de Sysmon capture des événements de base. Pour surveiller plus en détail, un fichier XML de configuration personnalisé peut être créé.
  - Un exemple de fichier XML pour capturer des événements spécifiques (comme la création de processus et les connexions réseau) est disponible [ici](https://github.com/SwiftOnSecurity/sysmon-config).

- **Application du Fichier de Configuration :**
  1. Une fois le fichier XML prêt, appliquez-le en utilisant la commande suivante :
     ```bash
     sysmon -c chemin\vers\configuration.xml
     ```
  2. Cette commande recharge Sysmon avec la nouvelle configuration sans nécessiter de réinstallation.

**Étape 3 : Surveillance des Événements avec Sysmon**
- **Visualisation des Logs :**
  - Les événements capturés par Sysmon sont enregistrés dans les journaux d'événements Windows, sous **Applications and Services Logs > Microsoft > Windows > Sysmon/Operational**.
  - Utilisez l'outil **Event Viewer** pour consulter ces journaux :
    1. Ouvrez l'Event Viewer.
    2. Naviguez vers le chemin mentionné ci-dessus.
    3. Filtrez les événements par ID pour détecter les activités spécifiques.

**Étape 4 : Exemple Pratique**
- **Scénario :** Surveiller la création de processus sur le système pour identifier si des processus inconnus ou inattendus sont créés.
- **Action :**
  1. Créez un fichier de configuration XML pour capturer la création de processus (Event ID 1).
  2. Appliquez-le en suivant les étapes précédentes.
  3. Lancez un programme, par exemple **notepad.exe**, et vérifiez dans l'Event Viewer si l'événement de création de processus a été capturé.

#### <a name="process-monitor"></a>**2.2 Process Monitor**

**Objectif :**
Process Monitor, également de la suite Sysinternals, permet de surveiller en temps réel les activités du système, y compris les accès au registre, aux fichiers, et aux processus. Il est particulièrement utile pour diagnostiquer les problèmes système et analyser les comportements suspects.

**Étape 1 : Téléchargement et Lancement de Process Monitor**
- **Téléchargement :**
  1. Allez sur la page officielle de [Process Monitor](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon).
  2. Téléchargez l'outil et extrayez-le dans un dossier de votre choix.

- **Lancement :**
  1. Exécutez **procmon.exe** depuis l'endroit où il a été extrait.
  2. Une fenêtre s'ouvrira automatiquement, montrant l'activité en temps réel du système.

**Étape 2 : Filtrage des Activités**
- **Configuration du Filtrage :**
  - Process Monitor capture une énorme quantité de données. Pour se concentrer sur des activités spécifiques, utilisez les filtres :
    1. Cliquez sur **Filter** dans le menu.
    2. Sélectionnez le critère à surveiller (par exemple, les événements liés à un processus spécifique ou à un type d'activité, comme l'écriture dans le registre).
    3. Appliquez les filtres pour ne voir que les événements pertinents.

**Étape 3 : Surveillance en Temps Réel**
- **Observation des Modifications :**
  - Lancez un programme ou effectuez une action (par exemple, modifier une clé de registre ou un fichier) et observez en temps réel comment Process Monitor capture ces événements.
  - Chaque ligne dans l'interface de Process Monitor représente un événement capturé, avec des détails sur l'horodatage, le processus impliqué, et l'activité effectuée (lecture/écriture/modification).

**Étape 4 : Analyse des Résultats**
- **Recherche de Comportements Suspects :**
  - Si un programme est suspecté d'effectuer des modifications non autorisées (par exemple, modification des fichiers système ou du registre), Process Monitor peut identifier précisément quelles actions sont entreprises.
  - Chaque événement peut être examiné en détail, avec des informations sur les paramètres d'appel système utilisés et les chemins d'accès impliqués.

**Étape 5 : Exemple Pratique**
- **Scénario :** Surveiller toute tentative de modification d'une clé spécifique du registre par un programme inconnu.
- **Action :**
  1. Configurez un filtre dans Process Monitor pour surveiller les événements **RegSetValue** pour une clé spécifique.
  2. Lancez le programme suspect.
  3. Examinez les événements capturés pour déterminer si le programme tente de modifier la clé.

### <a name="conclusion-et-démo-pratique"></a>**Conclusion et Démo Pratique**

- **Objectif :** À la fin de cette session, être capable d'installer et configurer Sysmon pour surveiller des événements système critiques, et utiliser Process Monitor pour observer et analyser les activités en temps réel sur le système.
- **Démonstration Pratique :**
  - **Étapes :**
    1. Configurer Sysmon pour capturer les événements critiques.
    2. Utiliser Process Monitor pour observer les détails spécifiques de l'activité suspecte.
    3. Analyser les journaux pour identifier et répondre aux violations de sécurité potentielles.

### <a name="annexe-troubleshooting"></a>**Annexe - Troubleshooting**

Il est possible que le chemin exact pour accéder aux journaux de Sysmon ne soit pas immédiatement visible dans l'Event Viewer (Visionneuse d'événements) en fonction de la configuration ou de la version de Windows. Voici comment accéder aux journaux de Sysmon :

1. **Ouvrir la Visionneuse d'événements :**
   - Appuyez sur `Win + R`, tapez `eventvwr.msc`, puis appuyez sur `Entrée`. Cela ouvrira la Visionneuse d'événements.

2. **Naviguer dans les Journaux Windows :**
   - Dans le volet de gauche, déroulez **Journaux des applications et des services** (Applications and Services Logs).
   - Ensuite, déroulez **Microsoft**.

3. **Trouver Sysmon :**
   - Sous **Microsoft**, cherchez le dossier **Windows**.
   - À l'intérieur du dossier **Windows**, un sous-dossier nommé **Sysmon** devrait être présent.
   - Ouvrez ce dossier, puis sélectionnez **Operational** pour voir les événements enregistrés par Sysmon.

### **Alternative : Utilisation de la Recherche dans l'Event Viewer**

Si le chemin exact ne se trouve pas, la fonction de recherche peut être utilisée pour localiser les événements spécifiques liés à Sysmon :

1. **Utilisation de la Recherche :**
   - Dans la Visionneuse d'événements, faites un clic droit sur **Journaux Windows** ou **Journaux des applications et des services**, puis sélectionnez **Rechercher**.
   - Tapez "Sysmon" dans le champ de recherche pour filtrer et afficher les journaux associés.

### **Vérification de l'Installation de Sysmon**

Si les journaux ne sont pas trouvés, il est possible que Sysmon ne soit pas correctement installé ou configuré. Voici comment vérifier :

1. **Réinstaller Sysmon :**
   - Ouvrez l'invite de commande en tant qu'administrateur.
   - Exécutez la commande suivante pour désinstaller Sysmon s'il est déjà installé :
     ```bash
     sysmon -u
     ```
   - Ensuite, réinstallez Sysmon avec la configuration par défaut

 :
     ```bash
     sysmon -accepteula -i
     ```

2. **Vérifiez de nouveau dans l'Event Viewer** après réinstallation.

### <a name="annexe2-gestion-de-sysmon"></a>**Annexe2 - Gestion de Sysmon**

## Référence : [Sysmon Configuration](https://github.com/SwiftOnSecurity/sysmon-config)

Commandes essentielles pour l'utilisation et la gestion de Sysmon avec une configuration spécifique :

### **Installation de Sysmon avec une Configuration Personnalisée**
Exécutez cette commande avec des droits administratifs pour installer Sysmon en utilisant un fichier de configuration personnalisé :
```bash
sysmon.exe -accepteula -i sysmonconfig-export.xml
```

### **Mise à Jour de la Configuration Existante de Sysmon**
Si Sysmon est déjà installé et que la configuration doit être mise à jour, utilisez la commande suivante avec des droits administratifs :
```bash
sysmon.exe -c sysmonconfig-export.xml
```

### **Désinstallation de Sysmon**
Pour désinstaller Sysmon, exécutez cette commande avec des droits administratifs :
```bash
sysmon.exe -u
```

Ces commandes permettent d'installer, mettre à jour, et désinstaller Sysmon en utilisant une configuration personnalisée. Il est recommandé d'utiliser un éditeur de texte comme Notepad++ pour modifier le fichier de configuration, car il prend en charge le format XML et le format de nouvelle ligne UNIX, facilitant ainsi la personnalisation.

[Revenir en haut](#sécurité-et-réponse-aux-incidents)

---

