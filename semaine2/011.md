Voici le plan de cours ajusté avec le contenu ajouté au début :

# **Sécurité et Réponse aux Incidents**

1. <a href="#introduction-aux-attaques-et-à-la-sécurité">**Introduction aux Attaques et à la Sécurité**</a>
   - <a href="#objectif">Objectif</a>
   - <a href="#types-dattaques-courantes">Types d'Attaques Courantes</a>
   - <a href="#phishing">Phishing</a>
   - <a href="#ddos-denial-of-service-distribué">DDoS (Denial of Service Distribué)</a>
   - <a href="#ransomware">Ransomware</a>
   - <a href="#pourquoi-surveiller-les-activités-au-sein-dune-infrastructure">Pourquoi Surveiller les Activités au Sein d'une Infrastructure ?</a>
   - <a href="#exemples-réels-dattaques-et-leur-impact">Exemples Réels d'Attaques et Leur Impact</a>

2. <a href="#détection-des-violations-de-sécurité">**Détection des Violations de Sécurité**</a>
   - <a href="#system-monitor-sysmon">System Monitor (Sysmon)</a>
   - <a href="#téléchargement-et-installation-de-sysmon">Téléchargement et Installation de Sysmon</a>
   - <a href="#configuration-de-sysmon">Configuration de Sysmon</a>
   - <a href="#surveillance-des-événements-avec-sysmon">Surveillance des Événements avec Sysmon</a>
   - <a href="#exemple-pratique">Exemple Pratique</a>
   - <a href="#process-monitor">Process Monitor</a>
   - <a href="#téléchargement-et-lancement-de-process-monitor">Téléchargement et Lancement de Process Monitor</a>
   - <a href="#filtrage-des-activités">Filtrage des Activités</a>
   - <a href="#surveillance-en-temps-réel">Surveillance en Temps Réel</a>
   - <a href="#analyse-des-résultats">Analyse des Résultats</a>
   - <a href="#exemple-pratique-1">Exemple Pratique</a>

3. <a href="#examen-de-lactivité-avec-les-outils-sysinternals">**Examen de l'Activité avec les Outils Sysinternals**</a>
   - <a href="#présentation-des-outils-sysinternals">Présentation des Outils Sysinternals</a>
   - <a href="#process-explorer">Process Explorer</a>
   - <a href="#autoruns">Autoruns</a>
   - <a href="#stratégies-dinvestigation-avec-sysinternals">Stratégies d'Investigation avec Sysinternals</a>
   - <a href="#approche-globale">Approche Globale</a>
   - <a href="#précautions-et-meilleures-pratiques">Précautions et Meilleures Pratiques</a>
   - <a href="#conclusion-avant-la-démonstration-pratique">Conclusion avant la Démonstration Pratique</a>

4. <a href="#stratégies-de-réponse-aux-incidents">**Stratégies de Réponse aux Incidents**</a>
   - <a href="#scénario-dentreprise-attaquée">Scénario d'Entreprise Attaquée</a>
   - <a href="#discussion-interactive">Discussion Interactive</a>
   - <a href="#plan-de-réponse-aux-incidents">Plan de Réponse aux Incidents</a>
   - <a href="#isolation-des-systèmes-compromis">Isolation des Systèmes Compromis</a>
   - <a href="#communication-de-crise">Communication de Crise</a>
   - <a href="#restauration-des-systèmes">Restauration des Systèmes</a>
   - <a href="#post-mortem-et-amélioration-continue">Post-Mortem et Amélioration Continue</a>

5. <a href="#atelier-pratique">**Atelier Pratique**</a>
   - <a href="#préambule--choix-du-système-dexploitation">Préambule : Choix du Système d'Exploitation</a>
   - <a href="#exercice-1--configurer-sysmon-sur-une-machine-virtuelle-et-détecter-une-activité-anormale">Exercice 1 : Configurer Sysmon sur une Machine Virtuelle et Détecter une Activité Anormale</a>
   - <a href="#exercice-2--utiliser-process-monitor-pour-suivre-lactivité-dun-processus-malveillant-simulé">Exercice 2 : Utiliser Process Monitor pour Suivre l'Activité d'un Processus Malveillant Simulé</a>
   - <a href="#exercice-3--analyser-une-machine-infectée-avec-les-outils-sysinternals-et-rédiger-un-rapport-dincident">Exercice 3 : Analyser une Machine Infectée avec les Outils Sysinternals et Rédiger un Rapport d'Incident</a>

6. <a href="#conclusion-et-qa">**Conclusion et Q&A**</a>
   - <a href="#synthèse">Synthèse</a>
   - <a href="#questions-et-réponses">Questions et Réponses</a>

---

### <a name="introduction-aux-attaques-et-à-la-sécurité"></a>Introduction aux Attaques et à la Sécurité

- <a name="objectif"></a>**Objectif** : Sensibiliser aux différents types d'attaques courantes qui menacent les infrastructures informatiques modernes. Les attaques comme le phishing, les attaques par déni de service distribué (DDoS), et les ransomwares sont devenues de plus en plus sophistiquées et fréquentes. Comprendre ces attaques est essentiel pour mettre en place des stratégies efficaces de surveillance et de réponse.
- <a name="types-dattaques-courantes"></a>**Types d'Attaques Courantes**
  - <a name="phishing"></a>**Phishing**
    - **Description** : Le phishing est une technique d'attaque qui consiste à tromper les utilisateurs pour qu'ils divulguent des informations sensibles (comme des identifiants de connexion ou des informations bancaires) en se faisant passer pour une entité de confiance, souvent via des emails ou des sites web falsifiés.
    - **Mécanisme** : Les attaquants envoient des emails contenant des liens vers des sites web factices ou des pièces jointes malveillantes. Lorsque l'utilisateur clique sur le lien ou ouvre la pièce jointe, il peut être amené à entrer ses informations personnelles, qui sont ensuite collectées par les cybercriminels.
    - **Exemple Réel** : En 2020, une campagne de phishing massive a ciblé les utilisateurs de Microsoft Office 365, où des emails se faisant passer pour des notifications de mise à jour de compte ont incité les utilisateurs à entrer leurs identifiants sur un site frauduleux.
  - <a name="ddos-denial-of-service-distribué"></a>**DDoS (Denial of Service Distribué)**
    - **Description** : Les attaques DDoS visent à rendre un service ou un site web indisponible en le submergeant de requêtes simultanées provenant de multiples systèmes compromis (appelés botnets).
    - **Mécanisme** : Ces attaques exploitent la capacité limitée d'un serveur à traiter un nombre important de requêtes, le saturant jusqu'à ce qu'il devienne incapable de répondre aux requêtes légitimes.
    - **Exemple Réel** : En 2016, l'attaque DDoS sur Dyn, un fournisseur de DNS, a provoqué la panne de nombreux services majeurs, y compris Twitter, Netflix, et Reddit. Cette attaque a été menée en utilisant le botnet Mirai, qui exploitait des milliers d'appareils IoT.
  - <a name="ransomware"></a>**Ransomware**
    - **Description** : Un ransomware est un type de logiciel malveillant qui chiffre les fichiers de la victime et exige une rançon en échange de la clé de déchiffrement.
    - **Mécanisme** : L'infection peut se produire via des emails de phishing, des téléchargements malveillants, ou des failles de sécurité dans des systèmes non mis à jour. Une fois le ransomware installé, il commence à chiffrer les fichiers de l'utilisateur, rendant le système inutilisable.
    - **Exemple Réel** : WannaCry, en 2017, est l'une des attaques de ransomware les plus célèbres. Exploitant une vulnérabilité dans le système Windows, il a infecté plus de 230 000 ordinateurs dans 150 pays, affectant des organisations telles que le National Health Service (NHS) au Royaume-Uni.

- <a name="pourquoi-surveiller-les-activités-au-sein-dune-infrastructure"></a>**Pourquoi Surveiller les Activités au Sein d'une Infrastructure ?**
  - **Prévention des Violations de Données**
    - **Description** : La surveillance des activités réseau et des systèmes permet

 de détecter les comportements anormaux ou non autorisés avant qu'ils ne causent des dommages importants.
    - **Exemple** : Une tentative d'accès non autorisé à une base de données sensible peut être rapidement identifiée et bloquée avant que les données ne soient exfiltrées.
  - **Réponse Rapide aux Incidents**
    - **Description** : Lorsqu'une attaque est détectée en temps réel, les équipes de sécurité peuvent intervenir immédiatement pour limiter l'impact, isoler les systèmes compromis, et commencer la récupération.
    - **Exemple** : Lors d'une attaque par ransomware, la détection précoce de l'activité de chiffrement peut permettre de déconnecter les systèmes avant que l'intégralité du réseau ne soit affectée.
  - **Conformité Réglementaire**
    - **Description** : De nombreuses industries sont soumises à des régulations strictes concernant la protection des données. La surveillance continue aide à garantir que l'entreprise respecte ces exigences légales.
    - **Exemple** : Le RGPD en Europe impose aux entreprises de signaler toute violation de données dans les 72 heures. Une surveillance efficace permet de respecter cette obligation légale.

- <a name="exemples-réels-dattaques-et-leur-impact"></a>**Exemples Réels d'Attaques et Leur Impact**
  - **L'attaque sur Target en 2013**
    - **Contexte** : Target, une chaîne de magasins américaine, a subi une des plus grandes violations de données de l'histoire, où les informations de carte de crédit de 40 millions de clients ont été compromises.
    - **Impact** : L'attaque a entraîné des pertes financières considérables, une baisse de confiance des clients, et des poursuites judiciaires. Elle a aussi poussé Target à investir massivement dans l'amélioration de sa cybersécurité.
  - **L'attaque de SolarWinds en 2020**
    - **Contexte** : Une compromission sophistiquée d'une mise à jour logicielle de SolarWinds, une société de gestion de réseau, a permis aux attaquants d'accéder aux systèmes de nombreuses agences gouvernementales et entreprises de premier plan.
    - **Impact** : Cette attaque, qui a duré plusieurs mois avant d'être découverte, a mis en lumière les risques associés à la chaîne d'approvisionnement des logiciels et a conduit à des révisions des pratiques de sécurité au niveau national.

### **Conclusion**
Comprendre les attaques courantes et adopter une surveillance proactive sont des éléments clés pour protéger les infrastructures informatiques. En restant vigilant et en utilisant les outils appropriés, il est possible non seulement de prévenir les attaques mais aussi de réagir efficacement pour minimiser les dommages.

---

### <a name="détection-des-violations-de-sécurité"></a>Détection des Violations de Sécurité

[Revenir en haut](#sécurité-et-réponse-aux-incidents)

---



### <a name="détection-des-violations-de-sécurité"></a>2. Détection des Violations de Sécurité

Cette section guide à travers la configuration et l'utilisation de deux outils de surveillance essentiels dans un environnement Windows : **System Monitor (Sysmon)** et **Process Monitor**. Ces outils permettent de détecter et d'enregistrer les activités suspectes sur un système, offrant ainsi les moyens d'identifier les violations de sécurité avant qu'elles ne causent des dommages importants.

#### <a name="system-monitor-sysmon"></a>**2.1 System Monitor (Sysmon)**

**Objectif :**
Sysmon, un outil de la suite Sysinternals, permet de surveiller et d'enregistrer les événements système. Il est particulièrement utile pour capturer des détails sur la création de processus, les connexions réseau, et les modifications de fichiers, qui peuvent être utilisés pour identifier des activités suspectes.

**Étape 1 : Téléchargement et Installation de Sysmon**
- **Téléchargement :**
  1. Rendez-vous sur le site officiel des [Sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon).
  2. Téléchargez l'archive contenant Sysmon.
  3. Extrayez l'archive dans un répertoire de votre choix.

- **Installation :**
  1. Ouvrez une invite de commande avec les privilèges d'administrateur.
  2. Accédez au répertoire où Sysmon a été extrait.
  3. Tapez la commande suivante pour installer Sysmon avec la configuration par défaut :
     ```bash
     sysmon -accepteula -i
     ```
     Cette commande accepte l'accord de licence utilisateur final (EULA) et installe Sysmon en utilisant la configuration par défaut.

**Étape 2 : Configuration de Sysmon**
- **Création d'un Fichier de Configuration Personnalisé :**
  - La configuration par défaut de Sysmon capture des événements de base. Pour surveiller plus en détail, un fichier XML de configuration personnalisé peut être créé.
  - Un exemple de fichier XML pour capturer des événements spécifiques (comme la création de processus et les connexions réseau) est disponible [ici](https://github.com/SwiftOnSecurity/sysmon-config).

- **Application du Fichier de Configuration :**
  1. Une fois le fichier XML prêt, appliquez-le en utilisant la commande suivante :
     ```bash
     sysmon -c chemin\vers\configuration.xml
     ```
  2. Cette commande recharge Sysmon avec la nouvelle configuration sans nécessiter de réinstallation.

**Étape 3 : Surveillance des Événements avec Sysmon**
- **Visualisation des Logs :**
  - Les événements capturés par Sysmon sont enregistrés dans les journaux d'événements Windows, sous **Applications and Services Logs > Microsoft > Windows > Sysmon/Operational**.
  - Utilisez l'outil **Event Viewer** pour consulter ces journaux :
    1. Ouvrez l'Event Viewer.
    2. Naviguez vers le chemin mentionné ci-dessus.
    3. Filtrez les événements par ID pour détecter les activités spécifiques.

**Étape 4 : Exemple Pratique**
- **Scénario :** Surveiller la création de processus sur le système pour identifier si des processus inconnus ou inattendus sont créés.
- **Action :**
  1. Créez un fichier de configuration XML pour capturer la création de processus (Event ID 1).
  2. Appliquez-le en suivant les étapes précédentes.
  3. Lancez un programme, par exemple **notepad.exe**, et vérifiez dans l'Event Viewer si l'événement de création de processus a été capturé.

#### <a name="process-monitor"></a>**2.2 Process Monitor**

**Objectif :**
Process Monitor, également de la suite Sysinternals, permet de surveiller en temps réel les activités du système, y compris les accès au registre, aux fichiers, et aux processus. Il est particulièrement utile pour diagnostiquer les problèmes système et analyser les comportements suspects.

**Étape 1 : Téléchargement et Lancement de Process Monitor**
- **Téléchargement :**
  1. Allez sur la page officielle de [Process Monitor](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon).
  2. Téléchargez l'outil et extrayez-le dans un dossier de votre choix.

- **Lancement :**
  1. Exécutez **procmon.exe** depuis l'endroit où il a été extrait.
  2. Une fenêtre s'ouvrira automatiquement, montrant l'activité en temps réel du système.

**Étape 2 : Filtrage des Activités**
- **Configuration du Filtrage :**
  - Process Monitor capture une énorme quantité de données. Pour se concentrer sur des activités spécifiques, utilisez les filtres :
    1. Cliquez sur **Filter** dans le menu.
    2. Sélectionnez le critère à surveiller (par exemple, les événements liés à un processus spécifique ou à un type d'activité, comme l'écriture dans le registre).
    3. Appliquez les filtres pour ne voir que les événements pertinents.

**Étape 3 : Surveillance en Temps Réel**
- **Observation des Modifications :**
  - Lancez un programme ou effectuez une action (par exemple, modifier une clé de registre ou un fichier) et observez en temps réel comment Process Monitor capture ces événements.
  - Chaque ligne dans l'interface de Process Monitor représente un événement capturé, avec des détails sur l'horodatage, le processus impliqué, et l'activité effectuée (lecture/écriture/modification).

**Étape 4 : Analyse des Résultats**
- **Recherche de Comportements Suspects :**
  - Si un programme est suspecté d'effectuer des modifications non autorisées (par exemple, modification des fichiers système ou du registre), Process Monitor peut identifier précisément quelles actions sont entreprises.
  - Chaque événement peut être examiné en détail, avec des informations sur les paramètres d'appel système utilisés et les chemins d'accès impliqués.

**Étape 5 : Exemple Pratique**
- **Scénario :** Surveiller toute tentative de modification d'une clé spécifique du registre par un programme inconnu.
- **Action :**
  1. Configurez un filtre dans Process Monitor pour surveiller les événements **RegSetValue** pour une clé spécifique.
  2. Lancez le programme suspect.
  3. Examinez les événements capturés pour déterminer si le programme tente de modifier la clé.

### <a name="conclusion-et-démo-pratique"></a>**Conclusion et Démo Pratique**

- **Objectif :** À la fin de cette session, être capable d'installer et configurer Sysmon pour surveiller des événements système critiques, et utiliser Process Monitor pour observer et analyser les activités en temps réel sur le système.
- **Démonstration Pratique :**
  - **Étapes :**
    1. Configurer Sysmon pour capturer les événements critiques.
    2. Utiliser Process Monitor pour observer les détails spécifiques de l'activité suspecte.
    3. Analyser les journaux pour identifier et répondre aux violations de sécurité potentielles.

### <a name="annexe-troubleshooting"></a>**Annexe - Troubleshooting**

Il est possible que le chemin exact pour accéder aux journaux de Sysmon ne soit pas immédiatement visible dans l'Event Viewer (Visionneuse d'événements) en fonction de la configuration ou de la version de Windows. Voici comment accéder aux journaux de Sysmon :

1. **Ouvrir la Visionneuse d'événements :**
   - Appuyez sur `Win + R`, tapez `eventvwr.msc`, puis appuyez sur `Entrée`. Cela ouvrira la Visionneuse d'événements.

2. **Naviguer dans les Journaux Windows :**
   - Dans le volet de gauche, déroulez **Journaux des applications et des services** (Applications and Services Logs).
   - Ensuite, déroulez **Microsoft**.

3. **Trouver Sysmon :**
   - Sous **Microsoft**, cherchez le dossier **Windows**.
   - À l'intérieur du dossier **Windows**, un sous-dossier nommé **Sysmon** devrait être présent.
   - Ouvrez ce dossier, puis sélectionnez **Operational** pour voir les événements enregistrés par Sysmon.

### **Alternative : Utilisation de la Recherche dans l'Event Viewer**

Si le chemin exact ne se trouve pas, la fonction de recherche peut être utilisée pour localiser les événements spécifiques liés à Sysmon :

1. **Utilisation de la Recherche :**
   - Dans la Visionneuse d'événements, faites un clic droit sur **Journaux Windows** ou **Journaux des applications et des services**, puis sélectionnez **Rechercher**.
   - Tapez "Sysmon" dans le champ de recherche pour filtrer et afficher les journaux associés.

### **Vérification de l'Installation de Sysmon**

Si les journaux ne sont pas trouvés, il est possible que Sysmon ne soit pas correctement installé ou configuré. Voici comment vérifier :

1. **Réinstaller Sysmon :**
   - Ouvrez l'invite de commande en tant qu'administrateur.
   - Exécutez la commande suivante pour désinstaller Sysmon s'il est déjà installé :
     ```bash
     sysmon -u
     ```
   - Ensuite, réinstallez Sysmon avec la configuration par défaut

 :
     ```bash
     sysmon -accepteula -i
     ```

2. **Vérifiez de nouveau dans l'Event Viewer** après réinstallation.

### <a name="annexe2-gestion-de-sysmon"></a>**Annexe2 - Gestion de Sysmon**

## Référence : [Sysmon Configuration](https://github.com/SwiftOnSecurity/sysmon-config)

Commandes essentielles pour l'utilisation et la gestion de Sysmon avec une configuration spécifique :

### **Installation de Sysmon avec une Configuration Personnalisée**
Exécutez cette commande avec des droits administratifs pour installer Sysmon en utilisant un fichier de configuration personnalisé :
```bash
sysmon.exe -accepteula -i sysmonconfig-export.xml
```

### **Mise à Jour de la Configuration Existante de Sysmon**
Si Sysmon est déjà installé et que la configuration doit être mise à jour, utilisez la commande suivante avec des droits administratifs :
```bash
sysmon.exe -c sysmonconfig-export.xml
```

### **Désinstallation de Sysmon**
Pour désinstaller Sysmon, exécutez cette commande avec des droits administratifs :
```bash
sysmon.exe -u
```

Ces commandes permettent d'installer, mettre à jour, et désinstaller Sysmon en utilisant une configuration personnalisée. Il est recommandé d'utiliser un éditeur de texte comme Notepad++ pour modifier le fichier de configuration, car il prend en charge le format XML et le format de nouvelle ligne UNIX, facilitant ainsi la personnalisation.

[Revenir en haut](#sécurité-et-réponse-aux-incidents)

---














# **Sécurité et Réponse aux Incidents**

1. <a href="#introduction-aux-attaques-et-à-la-sécurité">**Introduction aux Attaques et à la Sécurité**</a>
   - <a href="#objectif">Objectif</a>
   - <a href="#types-dattaques-courantes">Types d'Attaques Courantes</a>
     - <a href="#phishing">Phishing</a>
     - <a href="#ddos-denial-of-service-distribué">DDoS (Denial of Service Distribué)</a>
     - <a href="#ransomware">Ransomware</a>
   - <a href="#pourquoi-surveiller-les-activités-au-sein-dune-infrastructure">Pourquoi Surveiller les Activités au Sein d'une Infrastructure ?</a>
   - <a href="#exemples-réels-dattaques-et-leur-impact">Exemples Réels d'Attaques et Leur Impact</a>

2. <a href="#détection-des-violations-de-sécurité">**Détection des Violations de Sécurité**</a>
   - <a href="#system-monitor-sysmon">System Monitor (Sysmon)</a>
     - <a href="#téléchargement-et-installation-de-sysmon">Téléchargement et Installation de Sysmon</a>
     - <a href="#configuration-de-sysmon">Configuration de Sysmon</a>
     - <a href="#surveillance-des-événements-avec-sysmon">Surveillance des Événements avec Sysmon</a>
     - <a href="#exemple-pratique">Exemple Pratique</a>
   - <a href="#process-monitor">Process Monitor</a>
     - <a href="#téléchargement-et-lancement-de-process-monitor">Téléchargement et Lancement de Process Monitor</a>
     - <a href="#filtrage-des-activités">Filtrage des Activités</a>
     - <a href="#surveillance-en-temps-réel">Surveillance en Temps Réel</a>
     - <a href="#analyse-des-résultats">Analyse des Résultats</a>
     - <a href="#exemple-pratique-1">Exemple Pratique</a>

3. <a href="#examen-de-lactivité-avec-les-outils-sysinternals">**Examen de l'Activité avec les Outils Sysinternals**</a>
   - <a href="#présentation-des-outils-sysinternals">Présentation des Outils Sysinternals</a>
     - <a href="#process-explorer">Process Explorer</a>
     - <a href="#autoruns">Autoruns</a>
   - <a href="#stratégies-dinvestigation-avec-sysinternals">Stratégies d'Investigation avec Sysinternals</a>
     - <a href="#approche-globale">Approche Globale</a>
     - <a href="#précautions-et-meilleures-pratiques">Précautions et Meilleures Pratiques</a>
   - <a href="#conclusion-avant-la-démonstration-pratique">Conclusion avant la Démonstration Pratique</a>

4. <a href="#partie-pratique-sysinternals">**Partie pratique de l'Examen de l'Activité avec les Outils Sysinternals**</a>
   - <a href="#utilisation-process-explorer">Utilisation de Process Explorer</a>
   - <a href="#utilisation-autoruns">Utilisation d'Autoruns</a>
   - <a href="#cas-pratique-sysinternals">Cas Pratique : Analyse d'une Activité Suspecte</a>

5. <a href="#stratégies-de-réponse-aux-incidents">**Stratégies de Réponse aux Incidents**</a>
   - <a href="#scénario-dentreprise-attaquée">Scénario d'Entreprise Attaquée</a>
   - <a href="#discussion-interactive">Discussion Interactive</a>
   - <a href="#plan-de-réponse-aux-incidents">Plan de Réponse aux Incidents</a>
   - <a href="#isolation-des-systèmes-compromis">Isolation des Systèmes Compromis</a>
   - <a href="#communication-de-crise">Communication de Crise</a>
   - <a href="#restauration-des-systèmes">Restauration des Systèmes</a>
   - <a href="#post-mortem-et-amélioration-continue">Post-Mortem et Amélioration Continue</a>

6. <a href="#atelier-pratique">**Atelier Pratique**</a>
   - <a href="#préambule--choix-du-système-dexploitation">Préambule : Choix du Système d'Exploitation</a>
   - <a href="#exercice-1--configurer-sysmon-sur-une-machine-virtuelle-et-détecter-une-activité-anormale">Exercice 1 : Configurer Sysmon sur une Machine Virtuelle et Détecter une Activité Anormale</a>
   - <a href="#exercice-2--utiliser-process-monitor-pour-suivre-lactivité-dun-processus-malveillant-simulé">Exercice 2 : Utiliser Process Monitor pour Suivre l'Activité d'un Processus Malveillant Simulé</a>
   - <a href="#exercice-3--analyser-une-machine-infectée-avec-les-outils-sysinternals-et-rédiger-un-rapport-dincident">Exercice 3 : Analyser une Machine Infectée avec les Outils Sysinternals et Rédiger un Rapport d'Incident</a>

7. <a href="#conclusion-et-qa">**Conclusion et Q&A**</a>
   - <a href="#synthèse">Synthèse</a>
   - <a href="#questions-et-réponses">Questions et Réponses</a>

---

### <a name="introduction-aux-attaques-et-à-la-sécurité"></a>Introduction aux Attaques et à la Sécurité

- <a name="objectif"></a>**Objectif** : Sensibiliser aux différents types d'attaques courantes qui menacent les infrastructures informatiques modernes. Les attaques comme le phishing, les attaques par déni de service distribué (DDoS), et les ransomwares sont devenues de plus en plus sophistiquées et fréquentes. Comprendre ces attaques est essentiel pour mettre en place des stratégies efficaces de surveillance et de réponse.
- <a name="types-dattaques-courantes"></a>**Types d'Attaques Courantes**
  - <a name="phishing"></a>**Phishing**
    - **Description** : Le phishing est une technique d'attaque qui consiste à tromper les utilisateurs pour qu'ils divulguent des informations sensibles (comme des identifiants de connexion ou des informations bancaires) en se faisant passer pour une entité de confiance, souvent via des emails ou des sites web falsifiés.
    - **Mécanisme** : Les attaquants envoient des emails contenant des liens vers des sites web factices ou des pièces jointes malveillantes. Lorsque l'utilisateur clique sur le lien ou ouvre la pièce jointe, il peut être amené à entrer ses informations personnelles, qui sont ensuite collectées par les cybercriminels.
    - **Exemple Réel** : En 2020, une campagne de phishing massive a ciblé les utilisateurs de Microsoft Office 365, où des emails se faisant passer pour des notifications de mise à jour de compte ont incité les utilisateurs à entrer leurs identifiants sur un site frauduleux.
  - <a name="ddos-denial-of-service-distribué"></a>**DDoS (Denial of Service Distribué)**
    - **Description** : Les attaques DDoS visent à rendre un service ou un site web indisponible en le submergeant de requêtes simultanées provenant de multiples systèmes compromis (appelés botnets).
    - **Mécanisme** : Ces attaques exploitent la capacité limitée d'un serveur à traiter un nombre important de requêtes, le saturant jusqu'à ce qu'il devienne incapable de répondre aux requêtes légitimes.
    - **Exemple Réel** : En 2016, l'attaque DDoS sur Dyn, un fournisseur de DNS, a provoqué la panne de nombreux services majeurs, y compris Twitter, Netflix, et Reddit. Cette attaque a été menée en utilisant le botnet Mirai, qui exploitait des milliers d'appareils IoT.
  - <a name="ransomware"></a>**Ransomware**
    - **Description** : Un ransomware est un type de logiciel malveillant qui chiffre les fichiers de la victime et exige une rançon en échange de la clé de déchiffrement.
    - **Mécanisme** : L'infection peut se produire via des emails de phishing, des téléchargements malveillants, ou des failles de sécurité dans des systèmes non mis à jour. Une fois le ransomware installé, il commence à chiffrer les fichiers de l'utilisateur, rendant le système inutilisable.
    - **Exemple

 Réel** : WannaCry, en 2017, est l'une des attaques de ransomware les plus célèbres. Exploitant une vulnérabilité dans le système Windows, il a infecté plus de 230 000 ordinateurs dans 150 pays, affectant des organisations telles que le National Health Service (NHS) au Royaume-Uni.

- <a name="pourquoi-surveiller-les-activités-au-sein-dune-infrastructure"></a>**Pourquoi Surveiller les Activités au Sein d'une Infrastructure ?**
  - **Prévention des Violations de Données**
    - **Description** : La surveillance des activités réseau et des systèmes permet de détecter les comportements anormaux ou non autorisés avant qu'ils ne causent des dommages importants.
    - **Exemple** : Une tentative d'accès non autorisé à une base de données sensible peut être rapidement identifiée et bloquée avant que les données ne soient exfiltrées.
  - **Réponse Rapide aux Incidents**
    - **Description** : Lorsqu'une attaque est détectée en temps réel, les équipes de sécurité peuvent intervenir immédiatement pour limiter l'impact, isoler les systèmes compromis, et commencer la récupération.
    - **Exemple** : Lors d'une attaque par ransomware, la détection précoce de l'activité de chiffrement peut permettre de déconnecter les systèmes avant que l'intégralité du réseau ne soit affectée.
  - **Conformité Réglementaire**
    - **Description** : De nombreuses industries sont soumises à des régulations strictes concernant la protection des données. La surveillance continue aide à garantir que l'entreprise respecte ces exigences légales.
    - **Exemple** : Le RGPD en Europe impose aux entreprises de signaler toute violation de données dans les 72 heures. Une surveillance efficace permet de respecter cette obligation légale.

- <a name="exemples-réels-dattaques-et-leur-impact"></a>**Exemples Réels d'Attaques et Leur Impact**
  - **L'attaque sur Target en 2013**
    - **Contexte** : Target, une chaîne de magasins américaine, a subi une des plus grandes violations de données de l'histoire, où les informations de carte de crédit de 40 millions de clients ont été compromises.
    - **Impact** : L'attaque a entraîné des pertes financières considérables, une baisse de confiance des clients, et des poursuites judiciaires. Elle a aussi poussé Target à investir massivement dans l'amélioration de sa cybersécurité.
  - **L'attaque de SolarWinds en 2020**
    - **Contexte** : Une compromission sophistiquée d'une mise à jour logicielle de SolarWinds, une société de gestion de réseau, a permis aux attaquants d'accéder aux systèmes de nombreuses agences gouvernementales et entreprises de premier plan.
    - **Impact** : Cette attaque, qui a duré plusieurs mois avant d'être découverte, a mis en lumière les risques associés à la chaîne d'approvisionnement des logiciels et a conduit à des révisions des pratiques de sécurité au niveau national.

[Revenir en haut](#sécurité-et-réponse-aux-incidents)

---

### <a name="détection-des-violations-de-sécurité"></a>Détection des Violations de Sécurité

Cette section guide à travers la configuration et l'utilisation de deux outils de surveillance essentiels dans un environnement Windows : **System Monitor (Sysmon)** et **Process Monitor**. Ces outils permettent de détecter et d'enregistrer les activités suspectes sur un système, offrant ainsi les moyens d'identifier les violations de sécurité avant qu'elles ne causent des dommages importants.

#### <a name="system-monitor-sysmon"></a>**2.1 System Monitor (Sysmon)**

**Objectif :**
Sysmon, un outil de la suite Sysinternals, permet de surveiller et d'enregistrer les événements système. Il est particulièrement utile pour capturer des détails sur la création de processus, les connexions réseau, et les modifications de fichiers, qui peuvent être utilisés pour identifier des activités suspectes.

**Étape 1 : Téléchargement et Installation de Sysmon**
- **Téléchargement :**
  1. Rendez-vous sur le site officiel des [Sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon).
  2. Téléchargez l'archive contenant Sysmon.
  3. Extrayez l'archive dans un répertoire de votre choix.

- **Installation :**
  1. Ouvrez une invite de commande avec les privilèges d'administrateur.
  2. Accédez au répertoire où Sysmon a été extrait.
  3. Tapez la commande suivante pour installer Sysmon avec la configuration par défaut :
     ```bash
     sysmon -accepteula -i
     ```
     Cette commande accepte l'accord de licence utilisateur final (EULA) et installe Sysmon en utilisant la configuration par défaut.

**Étape 2 : Configuration de Sysmon**
- **Création d'un Fichier de Configuration Personnalisé :**
  - La configuration par défaut de Sysmon capture des événements de base. Pour surveiller plus en détail, un fichier XML de configuration personnalisé peut être créé.
  - Un exemple de fichier XML pour capturer des événements spécifiques (comme la création de processus et les connexions réseau) est disponible [ici](https://github.com/SwiftOnSecurity/sysmon-config).

- **Application du Fichier de Configuration :**
  1. Une fois le fichier XML prêt, appliquez-le en utilisant la commande suivante :
     ```bash
     sysmon -c chemin\vers\configuration.xml
     ```
  2. Cette commande recharge Sysmon avec la nouvelle configuration sans nécessiter de réinstallation.

**Étape 3 : Surveillance des Événements avec Sysmon**
- **Visualisation des Logs :**
  - Les événements capturés par Sysmon sont enregistrés dans les journaux d'événements Windows, sous **Applications and Services Logs > Microsoft > Windows > Sysmon/Operational**.
  - Utilisez l'outil **Event Viewer** pour consulter ces journaux :
    1. Ouvrez l'Event Viewer.
    2. Naviguez vers le chemin mentionné ci-dessus.
    3. Filtrez les événements par ID pour détecter les activités spécifiques.

**Étape 4 : Exemple Pratique**
- **Scénario :** Surveiller la création de processus sur le système pour identifier si des processus inconnus ou inattendus sont créés.
- **Action :**
  1. Créez un fichier de configuration XML pour capturer la création de processus (Event ID 1).
  2. Appliquez-le en suivant les étapes précédentes.
  3. Lancez un programme, par exemple **notepad.exe**, et vérifiez dans l'Event Viewer si l'événement de création de processus a été capturé.

#### <a name="process-monitor"></a>**2.2 Process Monitor**

**Objectif :**
Process Monitor, également de la suite Sysinternals, permet de surveiller en temps réel les activités du système, y compris les accès au registre, aux fichiers, et aux processus. Il est particulièrement utile pour diagnostiquer les problèmes système et analyser les comportements suspects.

**Étape 1 : Téléchargement et Lancement de Process Monitor**
- **Téléchargement :**
  1. Allez sur la page officielle de [Process Monitor](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon).
  2. Téléchargez l'outil et extrayez-le dans un dossier de votre choix.

- **Lancement :**
  1. Exécutez **procmon.exe** depuis l'endroit où il a été extrait.
  2. Une fenêtre s'ouvrira automatiquement, montrant l'activité en temps réel du système.

**Étape 2 : Filtrage des Activités**
- **Configuration du Filtrage :**
  - Process Monitor capture une énorme quantité de données. Pour se concentrer sur des activités spécifiques, utilisez les filtres :
    1. Cliquez sur **Filter** dans le menu.
    2. Sélectionnez le critère à surveiller (par exemple, les événements liés à un processus spécifique ou à un type d'activité, comme l'écriture dans le registre).
    3. Appliquez les filtres pour ne voir que les événements pertinents.

**Étape 3 : Surveillance en Temps Réel**
- **Observation des Modifications :**
  - Lancez un programme ou effectuez une action (par exemple, modifier une clé de registre ou un fichier) et observez en temps réel comment Process Monitor capture ces événements.
  - Chaque ligne dans l'interface de Process Monitor représente un événement capturé, avec des détails sur l'horodatage, le processus impliqué, et l'activité effectuée (lecture/écriture/modification).

**Étape 4 : Analyse des Résultats**
- **Recherche de Comportements Suspects :**
  - Si un programme est suspecté d'effectuer des modifications non autorisées (par exemple, modification des fichiers système ou du registre), Process Monitor peut identifier précisément quelles actions sont entreprises.
  - Chaque événement peut être examiné en détail, avec des informations sur les paramètres d'appel système utilisés et les chemins d'accès impliqués.

**Étape 5 : Exemple Pratique**
- **Scénario :** Surveiller toute tentative de modification d'une clé spécifique du registre par un programme inconnu.
- **Action :**
  1. Configurez un filtre dans Process Monitor pour surveiller les événements **RegSetValue** pour une clé spécifique.
  2

. Lancez le programme suspect.
  3. Examinez les événements capturés pour déterminer si le programme tente de modifier la clé.

### <a name="conclusion-et-démo-pratique"></a>**Conclusion et Démo Pratique**

- **Objectif :** À la fin de cette session, être capable d'installer et configurer Sysmon pour surveiller des événements système critiques, et utiliser Process Monitor pour observer et analyser les activités en temps réel sur le système.
- **Démonstration Pratique :**
  - **Étapes :**
    1. Configurer Sysmon pour capturer les événements critiques.
    2. Utiliser Process Monitor pour observer les détails spécifiques de l'activité suspecte.
    3. Analyser les journaux pour identifier et répondre aux violations de sécurité potentielles.

[Revenir en haut](#sécurité-et-réponse-aux-incidents)

---

### <a name="examen-de-lactivité-avec-les-outils-sysinternals"></a>Examen de l'Activité avec les Outils Sysinternals

#### <a name="présentation-des-outils-sysinternals"></a>**3.1 Présentation des Outils Sysinternals**

Les outils Sysinternals ont été développés par Mark Russinovich et sont maintenant maintenus par Microsoft. Ils offrent des fonctionnalités avancées pour la gestion et le diagnostic des systèmes Windows. Voici un aperçu des deux outils principaux que nous allons utiliser :

- <a name="process-explorer"></a>**Process Explorer** :
  - **Description** : Process Explorer est un gestionnaire de tâches avancé qui fournit une vue détaillée des processus en cours d'exécution sur un système. Contrairement au gestionnaire de tâches Windows classique, Process Explorer permet de visualiser les processus sous forme d'arborescence, ce qui montre les relations hiérarchiques entre eux. Il permet également de voir les fichiers, les handles, et les bibliothèques DLL utilisés par chaque processus.
  - **Utilisations typiques** : Process Explorer est utilisé pour diagnostiquer les problèmes de performances, détecter les logiciels malveillants cachés, et analyser les processus suspects.

- <a name="autoruns"></a>**Autoruns** :
  - **Description** : Autoruns montre quels programmes sont configurés pour démarrer automatiquement lors du démarrage du système ou de l'ouverture de session. Il répertorie les emplacements de démarrage standard (comme le dossier de démarrage Windows), ainsi que des emplacements plus cachés, souvent exploités par des logiciels malveillants pour garantir leur persistance.
  - **Utilisations typiques** : Autoruns est utilisé pour désactiver ou supprimer des programmes de démarrage indésirables, nettoyer les entrées de démarrage pour améliorer les performances, et identifier les logiciels malveillants qui se lancent au démarrage du système.

#### <a name="stratégies-dinvestigation-avec-sysinternals"></a>**3.2 Stratégies d'Investigation avec Sysinternals**

**Approche Globale :**
- <a name="approche-globale"></a>**Étape 1 : Identification Initiale des Symptômes**
  - Notez les symptômes observés sur le système, tels qu'un ralentissement inhabituel, des messages d'erreur récurrents, ou des comportements anormaux. Ces symptômes vous donneront des indices sur les processus ou services à surveiller.

- **Étape 2 : Utilisation de Process Explorer pour la Surveillance en Temps Réel**
  - Lancez Process Explorer pour surveiller les processus en temps réel. Cherchez des anomalies, comme des processus inconnus, des utilisations de ressources anormales, ou des connexions réseau suspectes.

- **Étape 3 : Analyse des Points de Démarrage avec Autoruns**
  - Après avoir identifié des processus suspects, utilisez Autoruns pour vérifier si ces processus sont configurés pour se lancer au démarrage. Cela vous permet d'évaluer la persistance potentielle des logiciels malveillants.

- **Étape 4 : Corrélation des Résultats**
  - Corrélez les informations recueillies à partir de Process Explorer et Autoruns. Par exemple, si un processus suspect est détecté dans Process Explorer et se trouve également dans les entrées de démarrage d'Autoruns, il y a de fortes chances qu'il soit malveillant.

**Précautions et Meilleures Pratiques :**
- <a name="précautions-et-meilleures-pratiques"></a>**Toujours vérifier les Signatures** :
  - Vérifiez systématiquement les signatures numériques des processus et des programmes de démarrage. Les processus non signés ne sont pas nécessairement malveillants, mais ils méritent une attention particulière.

- **Comparer avec des Bases de Données en Ligne** :
  - Utilisez des bases de données en ligne et des recherches Google pour obtenir plus d'informations sur les processus suspects. De nombreux sites comme VirusTotal permettent de soumettre des fichiers pour une analyse de malware.

- **Documenter les Observations** :
  - Documentez chaque étape et observation. Cela est crucial pour préparer un rapport d'incident et pour des analyses futures.

#### <a name="conclusion-avant-la-démonstration-pratique"></a>**Conclusion avant la Démonstration Pratique**

En comprenant et en maîtrisant les outils Sysinternals comme **Process Explorer** et **Autoruns**, vous êtes en mesure de surveiller de manière proactive votre système, de détecter des anomalies, et de réagir rapidement aux violations de sécurité. Ces outils offrent une profondeur d'analyse qui dépasse de loin les capacités des outils intégrés à Windows, faisant d'eux des incontournables pour tout professionnel de la sécurité.

---

### <a name="partie-pratique-sysinternals"></a>Partie pratique de l'Examen de l'Activité avec les Outils Sysinternals

#### <a name="utilisation-process-explorer"></a>**3.1 Utilisation de Process Explorer**

**Process Explorer** est un outil puissant qui fournit une vue en temps réel des processus en cours d'exécution sur un système Windows. Il permet de voir les détails des processus, y compris les fichiers ouverts, les DLL chargées, et les relations hiérarchiques entre les processus.

**Étape 1 : Téléchargement et Lancement de Process Explorer**
- **Téléchargement :**
  1. Téléchargez **Process Explorer** depuis le site officiel des [Sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer).
  2. Extrayez les fichiers dans un dossier de votre choix.

- **Lancement :**
  1. Exécutez **procexp.exe** en tant qu'administrateur pour obtenir une vue complète des processus.
  2. Vous verrez une interface avec une liste de tous les processus en cours, leurs sous-processus, et diverses informations associées.

**Étape 2 : Identification d'un Processus Suspect**
- **Recherche de Processus :**
  - Parcourez la liste des processus pour identifier un processus suspect. Un processus suspect pourrait être un processus inconnu, un processus utilisant une quantité anormalement élevée de ressources, ou un processus sans signature numérique valide.
  - Vous pouvez vérifier les propriétés du processus en faisant un clic droit et en sélectionnant **Properties**.

- **Analyse des Détails du Processus :**
  - **Onglet **Image**:** fournit des informations sur le chemin d'accès au fichier exécutable, la version, et l'éditeur. Un fichier avec un chemin ou un éditeur inconnu peut être suspect.
  - **Onglet **Strings**:** montre les chaînes de texte présentes dans le processus, qui peuvent révéler des intentions malveillantes si elles contiennent des instructions inhabituelles.
  - **Vérification des Connexions Réseau :** sous l'onglet **TCP/IP**, vous pouvez voir si le processus établit des connexions réseau. Cela peut aider à identifier des processus exfiltrant des données.

**Étape 3 : Isolation et Analyse du Processus**
- **Suspension ou Terminaison :**
  - Si vous suspectez fortement un processus, vous pouvez le suspendre temporairement pour empêcher toute action supplémentaire en cliquant sur **Suspend**.
  - Vous pouvez également terminer le processus via **Kill Process**, mais assurez-vous d'abord d'avoir collecté suffisamment d'informations pour l'analyse.

- **Extraction des Fichiers Liés :**
  - Utilisez l'onglet **Handle** pour voir quels fichiers le processus a ouverts. Cela peut révéler si le processus modifie des fichiers critiques du système ou d'autres ressources.

#### <a name="utilisation-autoruns"></a>**3.2 Utilisation d'Autoruns**

**Autoruns** est un autre outil essentiel qui montre quels programmes sont configurés pour démarrer automatiquement lors du démarrage de l'ordinateur ou de l'ouverture de session. Cet outil est utile pour identifier les programmes malveillants qui se cachent dans les emplacements de démarrage.

**Étape 1 : Téléchargement et Lancement d'Autoruns**
- **Téléchargement :**
  1. Téléchargez **Autoruns** depuis le site officiel des [Sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns).
  2. Extrayez les fichiers dans un dossier de votre choix.

- **Lancement :**
  1. Exécutez **autoruns.exe** en tant qu'administrateur pour voir une liste complète des emplacements de démarrage.
  2. Vous verrez un ensemble d'ong

lets correspondant à différents types d'emplacements de démarrage (par exemple, Logon, Services, Drivers).

**Étape 2 : Analyse des Entrées de Démarrage**
- **Examen des Programmes de Démarrage :**
  - Sous l'onglet **Logon**, examinez les programmes configurés pour démarrer lors de la connexion de l'utilisateur. Recherchez les programmes inconnus ou suspects.
  - Faites un clic droit sur une entrée suspecte et sélectionnez **Search Online** pour rechercher plus d'informations sur l'exécutable. Cela peut révéler si le fichier est reconnu comme malveillant.

- **Désactivation des Entrées Suspectes :**
  - Pour empêcher un programme suspect de se lancer au démarrage, décochez simplement la case à côté de l'entrée dans Autoruns.
  - Si vous identifiez un programme malveillant, vous pouvez également supprimer l'entrée définitivement via le menu contextuel.

**Étape 3 : Surveillance Continue**
- **Utilisation Régulière :**
  - Utilisez Autoruns régulièrement pour vérifier les modifications dans les emplacements de démarrage. Les programmes malveillants essaient souvent de s'ajouter à ces emplacements pour garantir leur exécution.
  - Comparez les résultats avec des rapports précédents pour détecter les changements non autorisés.

#### <a name="cas-pratique-sysinternals"></a>**3.3 Cas Pratique : Analyse d'une Activité Suspecte**

**Scénario :** 
Vous remarquez un ralentissement soudain et inhabituel de votre système. Vous suspectez qu'un programme malveillant pourrait être en train de s'exécuter en arrière-plan.

**Étape 1 : Identification du Processus avec Process Explorer**
- **Recherche de Processus :**
  1. Ouvrez Process Explorer et recherchez tout processus consommant une grande quantité de CPU ou de mémoire.
  2. Examinez les propriétés de ce processus pour vérifier son chemin d'accès, son éditeur, et ses connexions réseau.

- **Suspension du Processus :**
  1. Si le processus semble suspect, suspendez-le temporairement et continuez l'analyse des ressources qu'il utilise (fichiers ouverts, connexions réseau).

**Étape 2 : Vérification des Entrées de Démarrage avec Autoruns**
- **Vérification :**
  1. Ouvrez Autoruns et examinez les entrées sous l'onglet **Logon** pour voir si le processus suspect ou un autre fichier inconnu est configuré pour démarrer automatiquement.
  2. Désactivez ou supprimez les entrées suspectes pour prévenir leur exécution au prochain démarrage.

**Étape 3 : Analyse Complémentaire**
- **Examen des Chaînes :**
  1. Retournez dans Process Explorer, et sous l'onglet **Strings**, examinez les chaînes de texte pour détecter tout contenu potentiellement malveillant.
  2. Si vous trouvez des éléments suspects, effectuez une recherche en ligne pour obtenir plus d'informations.

- **Rapport :**
  1. Documentez vos découvertes et préparez un rapport d'incident. Assurez-vous d'inclure des captures d'écran, des chemins de fichiers, et toute information supplémentaire recueillie.

### **Conclusion**

Grâce à l'utilisation conjointe de **Process Explorer** et **Autoruns**, vous pouvez identifier, analyser, et neutraliser des menaces potentielles sur un système Windows. Ces outils offrent une vue approfondie des processus et des programmes de démarrage, vous permettant de détecter et de répondre rapidement aux activités suspectes.

[Revenir en haut](#sécurité-et-réponse-aux-incidents)

---


